# vue js. 6. CRUD

Необходимо разработать CRUD-приложение для управления сущностями Пост и Категория. Работа с сервером осуществляется через TanStack Query (Queries + Mutations).

Создаем страницы и настраиваем маршруты через `vue-router`.

## CRUD для категорий

Список категорий

- Таблица категорий - выводится имя и id.
- Удаление категории прям в таблице (заголовок в колонке: действия, а в таблице: кнопка удалить)

Создание категории

- Форма для создания.

Редактирование категории

- Форма редактирования.

(можно написать компонент формы и передавать его на страницу create и edit)

## CRUD для постов

Страница списка постов

- Вывести таблицу всех постов.
- Реализовать поиск по названию поста посредством query-параметра search.
- Поиск должен работать в реальном времени, добавить на форму debounce (читаем что это, используем `VueUse` там все есть).
- Данные должны загружаться через `useQuery()`.

Страница создания поста

- Реализовать форму создания нового поста.
- Поля: `name`, `content`, `image_url`, `category_id`.
- Отправка формы - через `useMutation()`.
- После успешного создания - переход на созданный пост.
- `image_url` это просто ссылка на любую картинку, ищите в интернете
- Перед отображением формы необходимо выполнить запрос к API и получить список категорий.
- Список категорий должен отображаться в виде `<select>`.
- Нужно заранее создать категории.

Страница редактирования поста

- Переход на страницу должен осуществляться через `slug` поста.
- Переход через таблицу, где название, это ссылка.
- Данные поста загружаются через Query.
- Должна быть кнопка удаления поста:
  - Удаление выполняется через Mutation.
  - После удаления - переход на список постов.
- После редактирования делаем `refetch` в контексте TanStack

## Маршрутизация

- Маршрут страницы редактирования должен передавать slug:
  - через `props` в роутере - смотрите мой пример
  - или через библиотеку `VueUse` и хук `useRouteParams`.

## Работа с API

- Все HTTP-запросы должны быть вынесены в отдельный модуль, например: `/src/api/posts.js` и `/src/api/categories.js`
- TanStack Query:
  - `useQuery` - для получения данных
  - `useMutation` - для создания, обновления, удаления
- Нельзя выполнять запросы напрямую через `axios`/`fetch` в компонентах.

Читая данные (GET запросы), настраиваем время жизни кэша, например 1 минута, после обновления и удаления, инвалидируем кэш. Смотрите мой пример.

## Обработка ошибок

Мутация из TanStack, если запрос на обновление, создание, был не удачным, вернет ошибку. Например создайте пост с одним названием, потом с таким же, будет ошибка, т.к `slug` уникальный, покажите(поймайте) ошибку.

Можете добавить валидацию через `regle` (не обязательно).

## Таблица

Используем компонент таблицы из задания 4.
в постах, через слоты настраиваем отображения картинок, на название поста вешаем `RouterLink`.
в категориях, через слоты, добавить кнопку для удаления.

## Backend

в архиве `backend`, бек на `fast-api`.

активируем виртуальное окружение,

вводим

```bash
pip install fastapi pydantic python-slugify sqlalchemy uvicorn
```

(Надеюсь python у всех есть, как работать с вирт. окружением и как устанавливать пакеты надеюсь вам рассказывали...)

после установки пакетов, вводим `python app.py` - запуститься сервер вот тут http://127.0.0.1:8000

если перейти по ссылке http://127.0.0.1:8000/docs увидите документацию по api, можно прям там создать категории и посты, посмотреть как работает поиск.

## Front

в папке `example` мои примеры которые я разбирал.

Создайте новый проект.

https://vuejs.org/guide/quick-start.html

Выбрать `vue-router`, `ESLint` и `Prettier`, остальное можно не выбирать.
Установить `tailwind`

Установить

- https://www.npmjs.com/package/@tanstack/vue-query
- https://vueuse.org/guide/

Команды:

```bash
npm i @tanstack/vue-query
npm i @vueuse/core
npm i axios
```

к tailwind, советую поставить плагин `@tailwindcss/forms`, для форм.

```bash
npm i @tailwindcss/forms
```

Для валидации форм:

```bash
npm i @regle/core @regle/rules
```
